// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð´ÑƒÐ»Ñ
var TelegramBot = require('node-telegram-bot-api');
// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
var config = require('./config.json');

// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð±Ð¾Ñ‚Ð° Ð¸ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ð¼ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¸ Ñ‚Ð´
var bot = new TelegramBot(config.token, {
	polling: true
});
// ÐžÐ¿Ð¾Ð²ÐµÑ‰ÐµÐ½Ð¸Ðµ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ð±Ð¾Ñ‚Ð°
console.log("Ð‘Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½!");

/*
	#1 ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð½Ð° Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ðµ ÑÐ»Ð¾Ð²Ð¾/ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ
*/

bot.onText(/ping/, (msg, match) => {

	var message = "pong!"; //Ð¢ÐµÐºÑÑ‚ Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð¼ Ð½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ

	// ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼ Ð² Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ message Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð½Ð°Ð¿Ð¸ÑÐ°Ð» Ð±Ð¾Ñ‚Ñƒ
	bot.sendMessage(msg.chat.id, message);
  
});

/*
	#1.1 ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÑÐ²Ð¾ÐµÐ³Ð¾ ID
*/

//	Ð”Ð°Ð½Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ /id ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð²Ñ‹Ð²ÐµÐ´ÐµÑ‚ Ð²Ð°Ñˆ ID. Ð­Ñ‚Ð¾ Ð²Ð°Ð¼ ÐµÑ‰Ðµ Ð¿Ñ€Ð¸Ð³Ð¾Ð´Ð¸Ñ‚ÑÑ
bot.onText(/\/id/, (msg, match) => {
	bot.sendMessage(msg.chat.id, msg.from.id);
});

/*
	#2 ÐœÐ½Ð¾Ð³Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ð¾Ð´Ð½Ñƒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ
*/

// ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ð¼ Ñ„Ð°Ð¹Ð», Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð±ÑƒÐ´ÐµÐ¼ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð·Ñ†Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð¸ Ð¸Ñ… Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð²
var commands = require('./commands.json');
// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÑŽÑ‰Ð°Ñ Ð¿Ñ€Ð¸ÑÐ»Ð°Ð½Ð½Ð¾Ðµ Ð±Ð¾Ñ‚Ñƒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ðµ
bot.on('message', (msg) => {
	// Ð¡Ð¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¼Ð°ÑÑÐ¸Ð² Ð¸Ð· ÐºÐ»ÑŽÑ‡ÐµÐ¹ (ÐºÐ¾Ð¼Ð°Ð½Ð´, Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ñ‚ÑŒ Ð±Ð¾Ñ‚)
	var cmd = Object.keys(commands);
	// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð¿Ñ€Ð¸ÑÐ»Ð°Ð½Ð½Ð°Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°, Ð² ÑÐ¿Ð¸ÑÐºÐµ
	// Ð˜ ÐµÑÐ»Ð¸ Ð¾Ð½Ð° ÐµÑÑ‚ÑŒ - Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚
	// Ð”Ð»Ñ Ð±Ð¾Ð»ÐµÐµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð½ÑƒÐ¶Ð½Ð¾ Ð·Ð°Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð² Ð½Ð¸Ð¶Ð½ÐµÐ¼ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð±Ð¾Ñ‚ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð» ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ Ð² Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ñ… Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ…
	if(cmd.includes(msg.text.toLowerCase())){
		bot.sendMessage(msg.chat.id, commands[msg.text.toLowerCase()]);
	}
});

/*
	#3 ÐÐ´Ð¼Ð¸Ð½-ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
*/

// Ð”Ð°Ð½Ð½ÑƒÑŽ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ ÑÐ¼Ð¾Ð¶ÐµÑ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð°Ð´Ð¼Ð¸Ð½, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑƒÐºÐ°Ð·Ð°Ð½ Ð² ÐºÐ¾Ð½Ñ„Ð¸Ð³Ðµ

// ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /admin Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ñƒ Ð²Ð°Ñ Ð¿Ñ€Ð°Ð² Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
bot.onText(/\/admin/, (msg, match) => {
	// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÑ…Ð¾Ð´Ð¸Ñ‚ÑÑ Ð»Ð¸ ID Ð°Ð´Ð¼Ð¸Ð½Ð° Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð° Ð¸ ID Ð½Ð°Ð¿Ð¸ÑÐ°Ð²ÑˆÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
	if(msg.from.id == config.adminID){
		var message = "Ð’Ñ‹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€!"; 
	}else{
		var message = "Ð’Ñ‹ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ!";
	}

	bot.sendMessage(msg.chat.id, message);
  
});

/*
	#3.1 ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð°Ð´Ð¼Ð¸Ð½Ð¾Ð²
*/

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ, Ð¿Ð¾Ñ…Ð¾Ð´Ð° Ð½Ð° Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÑƒÑŽ, Ð½Ð¾ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð¸Ðµ Ð² Ñ‚Ð¾Ð¼, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð°Ð´Ð¼Ð¸Ð½Ð°

// ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° /madmin Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ‡Ð½Ð° Ð¿ÐµÑ€Ð²Ð¾Ð¹, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½ÑƒÐ¶Ð½Ð° Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð°Ð´Ð¼Ð¸Ð½Ð¾Ð²
bot.onText(/\/madmin/, (msg, match) => {
	
	if(config.admins.includes(msg.from.id)){
		var message = "Ð’Ñ‹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€!"; 
	}else{
		var message = "Ð’Ñ‹ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ!";
	}

	bot.sendMessage(msg.chat.id, message);
  
});

/*
	#4 ÐŸÐ°Ñ€Ñƒ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
*/

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð±Ð¾Ñ‚Ðµ.
// Ð¡ ÐµÐµ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð»Ð¾Ð³Ð¸Ð½ Ð±Ð¾Ñ‚Ð° Ð¿Ñ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ð¸Ð»Ð¸ ÐºÐ°ÐºÐ¸Ñ…-Ð»Ð¸Ð±Ð¾ Ð¾Ð±ÑÑ‚Ð¾ÑÑ‚ÐµÐ»ÑŒÑÑ‚Ð²Ð°Ñ…
// Ð˜Ð»Ð¸ Ð¶Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¾Ð¿Ð¾Ð²ÐµÑ‰ÐµÐ½Ð¸Ðµ Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ð±Ð¾Ñ‚Ð° Ð² Ñ‚ÐµÐ»ÐµÐ³Ñ€Ð°Ð¼ Ð°Ð´Ð¼Ð¸Ð½Ð°
bot.getMe().then(function (value) {
	
	let message = "Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð±Ð¾Ñ‚ @" + value['username'];
	// Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ Ñ Ð»Ð¾Ð³Ð¾Ð¼ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ
	console.log(message);
	
	// ÐžÐ¿Ð¾Ð²ÐµÑ‰ÐµÐ½Ð¸Ðµ Ð°Ð´Ð¼Ð¸Ð½Ð°
	bot.sendMessage(config.adminID, message);

});


// ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
// Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð´Ð»Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ‚Ð°ÐºÐ¸Ðµ ÐºÐ°Ðº: Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÑÑÑ‹Ð»ÐºÐ¸; markdown; ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ id ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ, Ðº ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼Ñƒ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ.
var message = "ÐŸÑ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¾ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ñ… Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð½Ð°Ð¶Ð°Ð² Ð½Ð° ÑÑ‚Ñƒ ÐºÐ½Ð¾Ð¿ÐºÑƒ -> [ðŸ”µ](https://core.telegram.org/bots/api#sendmessage)";
bot.sendMessage(config.adminID, message, {
                                            'parse_mode': 'Markdown'
                                            , 'disable_web_page_preview': 'true'
                                        });